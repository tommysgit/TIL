# 데드락

교착상태라 불리우며 데드락에 걸린 프로세스들은 리소스를 얻기위해 대기하고 있거나 점유하고 있는 리소스를 해제하지 못하고 멈춰있는 상태

## 조건

- Mutual Exclusion (상호배제)
    - 임계영역의 자원을 오직 하나의 프로세스만 이용할 수 있어야한다.
- Hold & Wait
    - 최소한 하나의 자원을 잡고 있는 프로세스는 다른 프로세스가 잡고 있는 자원을 추가적으로 얻기위해 기다려야한다.
- No Preemption
    - 자원은 해당 자원을 점유하고 있는 프로세스로부터만 점유가 해제될 수 있다.
- Circular Wait
    - 프로세스의 집합에서 순환 형태로 대기해야한다.

## 해결방안

### 예방

데드락의 발생 조건 중 하나를 제거함으로써 해결한다.

- Mutual Exclusion 방지
    - 모든 자원을 공유 허용한다.
- Hold & Wait 방지
    - 모든 자원에 대해 선점 허용
- No Preemption 방지
    - 필요 자원을 한번에 모두 할당
- Circular Wait 방지
    - 자원에 고유 번호 부여 후 순서대로 할당

### 회피

프로세스에 자원을 할당하기 전에 자원을 할당했을 때 안전한 상태면 할당하는 방법 

ex) 은행원 알고리즘

### 탐지

탐지 알고리즘을 통하여 지속적으로 교착상태가 발생하였는지 확인한다. 대기 그래프와 은행원 알고리즘을 이용하여 탐지하는 방법이 있다.

- 대기 그래프
    - Resource Allocation Graph를 이용하여 자원을 하나씩 제거해주어 프로세스 끼리의 연결만 남아 있을 때 주기(cycle)이 있다면 교착 상태를 의미한다.
- 은행원 알고리즘
    - 불안정 상태면 교착상태라고 판단한다.

### 복구

- 프로세스 종료
    - 교착 상태의 프로세스 모두 중지
    - 교착 상태가 제거될 때까지 한 프로세스씩 중지
- 자원 선점

교착 상태의 프로세스가 점유하고 있는 자원을 선점하여 다른 프로세스에게 할당해 해당 프로세스를 정지시키는 방법

1. Selection of a Victim (희생자 선택)

       최소 피해를 줄 수 있는 프로세스를 선택한다.

  2. Rollback (롤백)

       안정한 상태로 되돌리거나 교착상태의 프로세스들을 재시작한다.
       - 전체를 재시작
       - 데드락을 멈출 수 있을만큼의 최소한의 프로세스만 재시작

   3. Starvation (기아 상태)

        한 프로세스가 계속 희생자 선택이 되는것을 막아야한다.
        희생자로 선택될 때마다 우선 순위를 높인다.