# SQL vs NoSQL

## SQL

SQL자체는 Structured Query Language의 약자로 **관계형 데이터베이스(RDBMS)**를 관리, 처리하기 위해 나온 프로그래밍 언어이다. DDL, DML, DCL등 다양한 쿼리 문법이 있다. SQL은 언어이지만 대부분의 RDBMS가 SQL문법을 기반으로 하기에 이 글에서 SQL은 RDBMS진영으로 보아도 될것같다.

### 특징

- 정해진 스키마에 따라 데이터를 저장하여 명확한 데이터 구조를 보장
- 중복된 데이터를 저장하지 않도록 하는 것이 목적
- 테이블 간의 Join을 통하여 복잡한 조회가 가능하고, 인덱스를 통한 검색성능 보장
- 스키마로 인해 데이터가 유연하지 못하고 스키마가 변경될 경우 관리하기 힘들다.

## NoSQL

Not Only SQL의 약자로 기존의 RDBMS가 해결할 수 없는 문제를 해결하기 위해 초기 오픈소스 형태로 등장

### 특징

NoSQL은 종류도 다양하고 정확하게 내려진 정의가 없어 아래의 특징은 일반적인 특징을 나타낸다.

- RDBMS와 달리 데이터 간의 관계를 정의하지 않는다.
- RDBMS에 비해 더 큰 용량의 데이터를 저장가능하다.
- 분산형 구조이다.
- 고정되지 않은 테이블 스키마를 갖는다.

### 종류

- Key-value
- Document
- Graph
- Column-family

## SQL NoSQL 차이

### 확장의 차이

- 수직적 확장성
SQL은 서버의 성능을 업그레이드 하여 확장하는 방식 CPU, Memory등을 업그레이드한다.
유지보수 비용이 더든다. → 성능 업그레이드의 경우 돈에 비례한만큼 성능이 올라가지 않는다.
- 수평적 확장성
NoSQL은 서버의 개수를 늘리면 응답속도를 보장하면서 저장공간을 늘릴 수 있다.
O(1)을 유지하면서 공간을 늘려 안정성 확보

### 쿼리 언어여부

SQL : 구조화된 테이블을 기반으로 쿼리를 이용하여 데이터를 다룬다. 따라서 복잡한 구조의 설계일수록 복잡한 쿼리를 사용

NoSQL : 일부 NoSQL에서 쿼리를 지원하지만 복잡한 쿼리를 잘 사용되지 않는다.

### 강한스키마 약한스키마

- 강한 스키마
    - 테이블에 부합하는 데이터 형식으로 CRUD
    - 인덱스를 걸어 전체 스키마를 조회하지 않아도 검색 성능이 효율적이다.
- 약한 스키마
    - 사용하고자 하는 데이터에 맞게 CRUD
    - key를 기준으로 쿼리를 작성하여 최대한 검색 성능을 보장하도록한다.

### ACID vs BASE

- ACID : SQL의 특징으로 데이터베이스의 트랜잭션이 안전하게 보장되어야 한다는 속성
    - Atomicity (원자성) : 하나의 트랜잭션의 CRUD작업이 전부 Commit을 하던가 Rollback을 하여 같은 결과를 반영할 수 있어야한다.
    - Consistency (일관성): 트랜잭션이 성공적으로 완료되면 일관성있는 상태를 유지해야한다.
    - Isolation (독립성) : 트랜잭션 수행 시 다른 트랜잭션이 끼어들어서는 안된다.
    - Durability (지속성) : 성공적으로 수행된 트랜잭션은 영구반영 되어야 한다.

→ 하나의 트랜잭션안에 비지니스 로직을 맞추어 Commit Rollback을 통한 데이터 정합성 유지 (Commit 중심)

- BASE : NoSQL의 특징으로 ACID와 대조적으로 가용성과 성능을 중심으로한 분산 시스템의 속성
    - Basically Available
        - 가용성 중시, 낙관적 잠금 및 큐 이용
        - 다수의 실패에도 가용성 보장, 다수의 스토리지에 복사본을 저장한다.
    - Soft State
        - 노드의 상태는 외부에서 전송된 데이터에 의해 결정된다.
        - 분산 노드간 업데이트는 노드에 데이터가 도착한 시점에 갱신한다.
    - Eventually Consistent
        - 일시적으로는 일관성 없는 상태가 되어도 결국에는 일관성 있는 상태가 된다.

→ 변경된 데이터에 대하여 어느정도 보장하지만 정확한 read를 반영하기 어렵다.

## 결론

> NoSQL이 SQL에 비해 장점이 있으나 서비스의 특성에 맞추어 선택하여야 한다.
> 

SQL

→ 설계한 스키마에 맞게 데이터를 관리하고 인덱스를 통한 일정한 성능과 트랜잭션이 온전히 보장되어야 한다.

NoSQL

→ 데이터의 정합성이나 일관성이 계속 유지되지 않더라도 확장성과 성능 자유로운 형식이 중요하다.