# 인덱스

## 인덱스란?

> **인덱스** : 데이터베이스분야에 있어서 테이블에 대한 동작의 속도를 높여주는 자료 구조를 일컫는다. 
- 위키백과 -
> 

특정 컬럼에 인덱스를 생성하면 별도의 메모리 공간에 정렬된 컬럼의 값과 주소 공간을 (key, value)한 쌍으로 묶어 저장한다. 책으로 비유하자면 인덱스는 책갈피, 주소 공간은 페이지, 컬럼 값은 책의 내용이라고 볼 수 있다. 따라서 대용량 데이터에서 특정 값을 조회하고자할 때 빠르게 조회할 수 있다.

## 인덱스 알고리즘

인덱싱에 사용되는 자료구조로는 B-Tree와 B+Tree가 있는데 둘다 균형 이진트리를 기반으로한 알고리즘이다.

> 균형 이진트리 : 이진트리의 높이를 일정하게 유지하는 방식으로 검색 성능이 O(logN)을 유지한다.
> 

### B-Tree

일반적인 이진트리와 다르게 하나의 노드에 여러 개의 데이터를 담을 수 있다. 담을 수 있는 데이터의 개수에 따라 N차 B-Tree라고도 부르며 이진트리보다 훨씬 많은 양의 데이터를 효율적으로 관리할 수 있다는 것이 특징이다. 또한 줄어든 높이에 따라 검색 성능이 더좋다고 볼 수 있다.
<img src = "https://velog.velcdn.com/images%2Femplam27%2Fpost%2Fddbae2c9-da94-457d-bad8-77ff6791255b%2FB트리 기본 형태.png"/>

- 특징
    - 각 노드의 데이터들은 정렬된 상태이다.
    - 데이터들은 중복되지 않는다.
    - 리프 노드의 높이는 같다.
    - 리프 노드를 제외한 노드들은 자식 노드를 최소한 N/2개 이상 가지고있다.

### B+Tree

기존 B-Tree는 모든 노드에 여러 개의 데이터가 들어갔지만 B+Tree는 데이터 노드라고 부르는 리프 노드에만 데이터를 저장한다.
즉, 리프 노드에만 데이터가 존재하고 리프 노드를 제외한 노드들은 인덱스 노드로 데이터가 존재하지 않는다. 또한 모든 데이터 노드는 연결리스트로 구성되어 특정 범위에 대한 검색이나 모든 데이터를 탐색할 때 더 유리하다고 볼 수 있다.

<img src = "https://thebook.io/img/080200/176.jpg"/>

- 특징
    - 각 노드의 데이터들은 정렬된 상태이다.
    - 데이터들은 중복되지 않는다.
    - 데이터 노드들은 연결리스트로 이루어져있다.
    - mysql InnoDB에서 사용하는 알고리즘이다.
    

### 해시테이블

특정 키를 해시 함수를 이용하여 바로 저장된 메모리에 접근하는 방식으로 O(1)이라는 매우 빠른 속도를 자랑한다. 하지만 데이터들이 정렬되어 있지 않고 데이터베이스에서 지원하는 다양한 연산(범위, 부등호 등)이 어렵기 때문에 실제 데이터베이스 인덱싱에 잘 사용 되지않는다고 한다.

<img src = "https://images.velog.io/images/syoung125/post/5c2f57da-642a-4404-bb06-dc1947a5f034/image.png"/>

- 특징
    - 등호(=)연산에 최적화 되어있다.
    - key, value쌍으로 저장을 한다.
    - 해시충돌이 발생할 수 있다.
    - 특정 키값을 찾을 때 O(1)으로 매우 빠른 속도

## 주의사항

인덱싱을 함으로서 오는 장점도 있지만 단점도 분명하다.

- 데이터 삽입, 삭제, 수정에 대한 추가 작업으로인한 성능하락
    - INSERT : 새로운 데이터 추가로인한 트리구조의 변경 (노드의 분열)
    - DELETE : 기존 데이터 삭제로 인한 트리 구조 변경 (노드의 병합)
    - UPDATE : DELETE와 INSERT로 인한 비효율적인 작업
- 카디널리티를 고려한 인덱싱
    - 카디널리티는 같은 값의 중복도를 의미한다.
    - 성별, 학교등 중복도가 높을 것으로 예상되는 데이터보다 이메일 주민번호등 고유한 값을 가질수록 인덱싱의 효과가 발휘된다고 볼 수 있다.
- 데이터베이스의 메모리 용량 고려